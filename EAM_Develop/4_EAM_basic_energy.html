<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EAM势函数拟合几个基础能量 | IfXie&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
    <meta name="description" content="The only way to do great work is to love what you do.">
    <meta name="keywords" content="Solid Mechanics, Molecular Dynamics, First-principles calculations, AI4S, Linux systems, anime, fitness, indie games on Steam">
    
    <link rel="preload" href="/assets/css/0.styles.2f1e26cc.css" as="style"><link rel="preload" href="/assets/js/app.73c90eca.js" as="script"><link rel="preload" href="/assets/js/2.080a77f4.js" as="script"><link rel="preload" href="/assets/js/78.09f354db.js" as="script"><link rel="prefetch" href="/assets/js/1.6ac72902.js"><link rel="prefetch" href="/assets/js/10.9b72ac83.js"><link rel="prefetch" href="/assets/js/100.d2b52f8e.js"><link rel="prefetch" href="/assets/js/101.acd1f940.js"><link rel="prefetch" href="/assets/js/102.43ef62eb.js"><link rel="prefetch" href="/assets/js/103.44c84529.js"><link rel="prefetch" href="/assets/js/104.18c7793f.js"><link rel="prefetch" href="/assets/js/105.d496d6c6.js"><link rel="prefetch" href="/assets/js/106.5524397b.js"><link rel="prefetch" href="/assets/js/107.35812819.js"><link rel="prefetch" href="/assets/js/108.e1d81bb0.js"><link rel="prefetch" href="/assets/js/109.63e6e9a4.js"><link rel="prefetch" href="/assets/js/11.b311e792.js"><link rel="prefetch" href="/assets/js/110.d3f12b55.js"><link rel="prefetch" href="/assets/js/111.3ee53f8c.js"><link rel="prefetch" href="/assets/js/112.73dbe29d.js"><link rel="prefetch" href="/assets/js/113.4dbccc0d.js"><link rel="prefetch" href="/assets/js/114.4d87c04d.js"><link rel="prefetch" href="/assets/js/115.fc6b8c64.js"><link rel="prefetch" href="/assets/js/116.c198d7e7.js"><link rel="prefetch" href="/assets/js/117.d1a2084d.js"><link rel="prefetch" href="/assets/js/118.10fc0833.js"><link rel="prefetch" href="/assets/js/119.55bf7ce5.js"><link rel="prefetch" href="/assets/js/12.7a4b315c.js"><link rel="prefetch" href="/assets/js/120.e2595c0b.js"><link rel="prefetch" href="/assets/js/121.8b5f937c.js"><link rel="prefetch" href="/assets/js/122.11973606.js"><link rel="prefetch" href="/assets/js/123.cc589003.js"><link rel="prefetch" href="/assets/js/124.906ace30.js"><link rel="prefetch" href="/assets/js/125.2469d784.js"><link rel="prefetch" href="/assets/js/126.06cbba38.js"><link rel="prefetch" href="/assets/js/127.24a041d2.js"><link rel="prefetch" href="/assets/js/128.e455929f.js"><link rel="prefetch" href="/assets/js/129.1298d8bc.js"><link rel="prefetch" href="/assets/js/13.cb54770e.js"><link rel="prefetch" href="/assets/js/130.e6a91bd4.js"><link rel="prefetch" href="/assets/js/131.ccee2779.js"><link rel="prefetch" href="/assets/js/132.f61e1a29.js"><link rel="prefetch" href="/assets/js/133.a90879f2.js"><link rel="prefetch" href="/assets/js/134.53e42cb7.js"><link rel="prefetch" href="/assets/js/135.3193592e.js"><link rel="prefetch" href="/assets/js/136.044cc463.js"><link rel="prefetch" href="/assets/js/137.ecb85d0d.js"><link rel="prefetch" href="/assets/js/138.2554e636.js"><link rel="prefetch" href="/assets/js/139.5c5c40cc.js"><link rel="prefetch" href="/assets/js/14.33b3a511.js"><link rel="prefetch" href="/assets/js/140.5c9d5492.js"><link rel="prefetch" href="/assets/js/141.0ed16515.js"><link rel="prefetch" href="/assets/js/142.4545bb40.js"><link rel="prefetch" href="/assets/js/143.8d439085.js"><link rel="prefetch" href="/assets/js/144.e46011c6.js"><link rel="prefetch" href="/assets/js/15.7a060ed3.js"><link rel="prefetch" href="/assets/js/16.0024828d.js"><link rel="prefetch" href="/assets/js/17.9c07e5f6.js"><link rel="prefetch" href="/assets/js/18.1e923ecc.js"><link rel="prefetch" href="/assets/js/19.e1c8388f.js"><link rel="prefetch" href="/assets/js/20.2259ccf7.js"><link rel="prefetch" href="/assets/js/21.0c64ffdc.js"><link rel="prefetch" href="/assets/js/22.65462b2d.js"><link rel="prefetch" href="/assets/js/23.46699b55.js"><link rel="prefetch" href="/assets/js/24.6943b294.js"><link rel="prefetch" href="/assets/js/25.bda36af5.js"><link rel="prefetch" href="/assets/js/26.01d8b412.js"><link rel="prefetch" href="/assets/js/27.81951ab1.js"><link rel="prefetch" href="/assets/js/28.2d5d6e68.js"><link rel="prefetch" href="/assets/js/29.dee10ff4.js"><link rel="prefetch" href="/assets/js/3.1df9f664.js"><link rel="prefetch" href="/assets/js/30.bf6dff90.js"><link rel="prefetch" href="/assets/js/31.f475e4f1.js"><link rel="prefetch" href="/assets/js/32.bd4824c3.js"><link rel="prefetch" href="/assets/js/33.a4954702.js"><link rel="prefetch" href="/assets/js/34.4b622792.js"><link rel="prefetch" href="/assets/js/35.6368b5e4.js"><link rel="prefetch" href="/assets/js/36.e1e48341.js"><link rel="prefetch" href="/assets/js/37.b68325cc.js"><link rel="prefetch" href="/assets/js/38.dce58977.js"><link rel="prefetch" href="/assets/js/39.a0f4ea3d.js"><link rel="prefetch" href="/assets/js/4.a7f00c8e.js"><link rel="prefetch" href="/assets/js/40.b5810f33.js"><link rel="prefetch" href="/assets/js/41.bb71fca8.js"><link rel="prefetch" href="/assets/js/42.bfcca98c.js"><link rel="prefetch" href="/assets/js/43.46d43632.js"><link rel="prefetch" href="/assets/js/44.cc807e40.js"><link rel="prefetch" href="/assets/js/45.156263d3.js"><link rel="prefetch" href="/assets/js/46.12b1c856.js"><link rel="prefetch" href="/assets/js/47.bba2ffa2.js"><link rel="prefetch" href="/assets/js/48.f4018060.js"><link rel="prefetch" href="/assets/js/49.82508e21.js"><link rel="prefetch" href="/assets/js/5.2fc16674.js"><link rel="prefetch" href="/assets/js/50.bf32ad75.js"><link rel="prefetch" href="/assets/js/51.02a7914e.js"><link rel="prefetch" href="/assets/js/52.8d97d5e5.js"><link rel="prefetch" href="/assets/js/53.3ae7077f.js"><link rel="prefetch" href="/assets/js/54.7fe0642d.js"><link rel="prefetch" href="/assets/js/55.7a2ad9b3.js"><link rel="prefetch" href="/assets/js/56.4c53da82.js"><link rel="prefetch" href="/assets/js/57.4a083d2d.js"><link rel="prefetch" href="/assets/js/58.9c83909b.js"><link rel="prefetch" href="/assets/js/59.de045829.js"><link rel="prefetch" href="/assets/js/6.fa7064cc.js"><link rel="prefetch" href="/assets/js/60.a560b390.js"><link rel="prefetch" href="/assets/js/61.cba6dd41.js"><link rel="prefetch" href="/assets/js/62.afec3279.js"><link rel="prefetch" href="/assets/js/63.5c66f93e.js"><link rel="prefetch" href="/assets/js/64.ff671f53.js"><link rel="prefetch" href="/assets/js/65.9ee788f2.js"><link rel="prefetch" href="/assets/js/66.60fb63d5.js"><link rel="prefetch" href="/assets/js/67.9bf86fce.js"><link rel="prefetch" href="/assets/js/68.a3c2b768.js"><link rel="prefetch" href="/assets/js/69.44909cfc.js"><link rel="prefetch" href="/assets/js/7.57fa1904.js"><link rel="prefetch" href="/assets/js/70.fa307f4b.js"><link rel="prefetch" href="/assets/js/71.b865d8b3.js"><link rel="prefetch" href="/assets/js/72.47d99373.js"><link rel="prefetch" href="/assets/js/73.8feb793c.js"><link rel="prefetch" href="/assets/js/74.ffe2337d.js"><link rel="prefetch" href="/assets/js/75.5a5bb293.js"><link rel="prefetch" href="/assets/js/76.6e3d053b.js"><link rel="prefetch" href="/assets/js/77.655c49f4.js"><link rel="prefetch" href="/assets/js/79.d0ee78da.js"><link rel="prefetch" href="/assets/js/80.11ea1981.js"><link rel="prefetch" href="/assets/js/81.0860b84b.js"><link rel="prefetch" href="/assets/js/82.54541709.js"><link rel="prefetch" href="/assets/js/83.b3a7a811.js"><link rel="prefetch" href="/assets/js/84.5d1aaa85.js"><link rel="prefetch" href="/assets/js/85.5a517792.js"><link rel="prefetch" href="/assets/js/86.8653a912.js"><link rel="prefetch" href="/assets/js/87.086b0ed6.js"><link rel="prefetch" href="/assets/js/88.89370ed5.js"><link rel="prefetch" href="/assets/js/89.1a7dc700.js"><link rel="prefetch" href="/assets/js/90.eb6f1cbe.js"><link rel="prefetch" href="/assets/js/91.13cb7829.js"><link rel="prefetch" href="/assets/js/92.55c3ba53.js"><link rel="prefetch" href="/assets/js/93.503fb64b.js"><link rel="prefetch" href="/assets/js/94.6c867b4e.js"><link rel="prefetch" href="/assets/js/95.70ae694d.js"><link rel="prefetch" href="/assets/js/96.4cbfe22d.js"><link rel="prefetch" href="/assets/js/97.c044914f.js"><link rel="prefetch" href="/assets/js/98.e5214e03.js"><link rel="prefetch" href="/assets/js/99.28d938dd.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5e8c0468.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2f1e26cc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="IfXie's Blog" class="logo"> <span class="site-name can-hide">IfXie's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/VASP_Learning/" class="nav-link">
  VASP学习路线
</a></div> <a href="https://github.com/IfXie-Solid-Mechanics/my-first-repo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/VASP_Learning/" class="nav-link">
  VASP学习路线
</a></div> <a href="https://github.com/IfXie-Solid-Mechanics/my-first-repo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>EAM势函数拟合几个基础能量</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/EAM_Develop/4_EAM_basic_energy.html#_1-内聚能与状态方程的拟合" class="sidebar-link">1. 内聚能与状态方程的拟合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/EAM_Develop/4_EAM_basic_energy.html#_1-1-理论部分" class="sidebar-link">1.1 理论部分</a></li><li class="sidebar-sub-header"><a href="/EAM_Develop/4_EAM_basic_energy.html#_1-2-代码实现" class="sidebar-link">1.2 代码实现</a></li></ul></li><li><a href="/EAM_Develop/4_EAM_basic_energy.html#_2-表面能的拟合" class="sidebar-link">2. 表面能的拟合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/EAM_Develop/4_EAM_basic_energy.html#_2-1-contcar的读取与周期性边界条件设置" class="sidebar-link">2.1 CONTCAR的读取与周期性边界条件设置</a></li><li class="sidebar-sub-header"><a href="/EAM_Develop/4_EAM_basic_energy.html#_2-2-表面能的计算" class="sidebar-link">2.2 表面能的计算</a></li></ul></li><li><a href="/EAM_Develop/4_EAM_basic_energy.html#附录1-内聚能状态方程目标函数" class="sidebar-link">附录1-内聚能状态方程目标函数</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/EAM_Develop/4_EAM_basic_energy.html#附录2-表面能计算结果" class="sidebar-link">附录2-表面能计算结果</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content single-column"><div class="main-content"><div class="theme-default-content custom-content content__default"><h1 id="eam势函数拟合几个基础能量"><a href="#eam势函数拟合几个基础能量" class="header-anchor">#</a> EAM势函数拟合几个基础能量</h1> <p>EAM势函数计算势能，有几个基础的能量物理量也需要加入拟合考虑范畴，分别是内聚能(cohesive energy)，状态方程以及表面能。</p> <p>这几个能量的拟合思路较为接近，均为模拟MD的能量计算过程。（由于这一部分的代码比较简单，所以我是直接自己编写的程序，没有调用LAMMPS的API）</p> <h2 id="_1-内聚能与状态方程的拟合"><a href="#_1-内聚能与状态方程的拟合" class="header-anchor">#</a> 1. 内聚能与状态方程的拟合</h2> <h3 id="_1-1-理论部分"><a href="#_1-1-理论部分" class="header-anchor">#</a> 1.1 理论部分</h3> <p>关于内聚能和状态方程的相关理论可以观看DFT部分的<a href="/VASP_Learning/45_VASP_equation_of_state.html">这篇教程</a></p> <h3 id="_1-2-代码实现"><a href="#_1-2-代码实现" class="header-anchor">#</a> 1.2 代码实现</h3> <p>首先通过DFT计算出单个原子的内聚能-体积状态方程(E-V)，然后将文件存储到eos-Ni-fcc.txt文本文件中，文件有n行，第一列为晶格常数，第二列为对应能量。</p> <p>然后使用能量计算代码basic_energy.py（具体见附录1），先从文本文件中读取状态方程信息，再计算出对应状态的内聚能，通过比较差值获得最终的target_function</p> <p>在用EAM计算内聚能的时候，仍然需要用到上一篇工作中的fcc-origin.txt文本文件。</p> <p>运用Zhou势的具体具体计算结果约为-4.52eV/atom，即Zhou在对cohesive energy时应该也是和Mishin一致的。</p> <h2 id="_2-表面能的拟合"><a href="#_2-表面能的拟合" class="header-anchor">#</a> 2. 表面能的拟合</h2> <p>表面能的计算需要和DFT计算结果深度绑定。即读取DFT计算结果的CONTCAR文件作为最终表面能计算的结果。并且还需要针对每一个原子都设置周期性边界条件进行计算。因此这一部分的代码会与之前所有部分都有较大的改动。</p> <h3 id="_2-1-contcar的读取与周期性边界条件设置"><a href="#_2-1-contcar的读取与周期性边界条件设置" class="header-anchor">#</a> 2.1 CONTCAR的读取与周期性边界条件设置</h3> <p>CONTCAR的读取</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> math

<span class="token keyword">def</span> <span class="token function">read_contcar</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;read CONTCAR file, return lattice vector and coordinates of atoms&quot;&quot;&quot;</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read lattice constant</span>
    scale <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read lattice vector</span>
    lattice <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        lattice<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>scale <span class="token operator">*</span> <span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    lattice <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># read atom type and atom count</span>
    atom_types <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    atom_counts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> lines<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    total_atoms <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>atom_counts<span class="token punctuation">)</span>
    
    <span class="token comment"># check coordinates type of CONTCAR</span>
    coord_type <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read atom coordinates</span>
    coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token operator">+</span> total_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        parts <span class="token operator">=</span> lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">:</span>
            coords<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> parts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    coords <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>coords<span class="token punctuation">)</span>
    
    <span class="token comment"># convert coordinates for d, direction</span>
    <span class="token keyword">if</span> coord_type<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        coords <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> lattice<span class="token punctuation">,</span> coords
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>周期性边界条件设置-1:将刚刚读取到的原子坐标放在box内部</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">apply_pbc</span><span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;apply pbc to convert atoms to the initial box&quot;&quot;&quot;</span>

    <span class="token comment"># cal the inverse of lattice vector</span>
    inv_lattice <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># convert atom coordinates to fractional coodinations</span>
    fractional <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> inv_lattice<span class="token punctuation">)</span>

    <span class="token comment"># make sure the atom fractional coordinates range in (0,1]</span>
    fractional <span class="token operator">-=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>fractional<span class="token punctuation">)</span>
    
    <span class="token comment"># turn back the direct coordinates</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>fractional<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>周期性边界条件设置-2:生成镜像超晶胞，超晶胞大小可以根据截断半价进行选取，通常情况下一个 <mjx-container jax="SVG" class="MathJax" style="direction:ltr;position:relative;"><svg xmlns="http://www.w3.org/2000/svg" width="8.925ex" height="1.557ex" role="img" focusable="false" viewBox="0 -666 3944.9 688" aria-hidden="true" style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.05ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1722.4,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2444.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3444.9,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn><mo>×</mo><mn>5</mn><mo>×</mo><mn>5</mn></math></mjx-assistive-mml></mjx-container>的超晶胞是足够的，并且VASP计算结果中原子数量也不多。（以llj势函数为例）</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">calculate_atomic_energies</span><span class="token punctuation">(</span>lattice<span class="token punctuation">,</span> coords<span class="token punctuation">,</span> cutoff<span class="token operator">=</span><span class="token number">7.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token comment"># apply pbc to convert atoms to the initial box</span>
    coords_pbc <span class="token operator">=</span> apply_pbc<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># create a 5x5x5 supercell</span>
    images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># calculation energies of every atom</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># atom i's direct coordinates</span>
            r_i <span class="token operator">=</span> coords_pbc<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

            <span class="token keyword">for</span> image <span class="token keyword">in</span> images<span class="token punctuation">:</span>
                <span class="token comment"># scan all atom j in view of pbc</span>
                r_j_image <span class="token operator">=</span> coords_pbc<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>image<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>

                <span class="token comment"># calculate the distance of i,j</span>
                delta <span class="token operator">=</span> r_j_image <span class="token operator">-</span> r_i
                dist <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>delta<span class="token punctuation">)</span>
                
                <span class="token comment"># if the distance is less than cutoff ,calculate energy</span>
                <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;</span> dist <span class="token operator">&lt;=</span> cutoff<span class="token punctuation">:</span>
                    energy_ij <span class="token operator">=</span> lj_potential<span class="token punctuation">(</span>dist<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> i <span class="token operator">==</span> j <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span>image <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        energies<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token operator">*</span> energy_ij
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        energies<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token operator">*</span> energy_ij  
    <span class="token keyword">return</span> energies
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="_2-2-表面能的计算"><a href="#_2-2-表面能的计算" class="header-anchor">#</a> 2.2 表面能的计算</h3> <p>将2.1中的部分代入EAM势能计算公式，然后再添加一个main来进行控制即可完成，具体代码见附录2。代码中计算面积的公式是按照x轴和y轴围成的面积来计算的，并且按照x和y的角度为90度（这个地方也可以用cdot直接改写，但是注意1/2关系）</p> <h2 id="附录1-内聚能状态方程目标函数"><a href="#附录1-内聚能状态方程目标函数" class="header-anchor">#</a> 附录1-内聚能状态方程目标函数</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> math

<span class="token comment">#-----some initial for fcc system-----</span>
a_0<span class="token operator">=</span><span class="token number">3.5196</span>                                        <span class="token comment"># lattice constant (A)</span>
r_e<span class="token operator">=</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">*</span> a_0                          <span class="token comment"># the nearest distance in fcc (A)</span>
omiga<span class="token operator">=</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">3</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">*</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">*</span> a_0<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span> <span class="token comment"># single atom's volume in fcc (A^3)</span>


r_cut<span class="token operator">=</span><span class="token number">7.01</span>                                      <span class="token comment"># cutoff radius</span>
rho_e<span class="token operator">=</span><span class="token number">27.562015</span>                                 <span class="token comment"># Zhou_Ni</span>
f_e<span class="token operator">=</span><span class="token number">2.007018</span>                                    <span class="token comment"># Zhou_Ni</span>
A<span class="token operator">=</span><span class="token number">0.429046</span>                                      <span class="token comment"># Zhou_Ni</span>
B<span class="token operator">=</span><span class="token number">0.633531</span>                                      <span class="token comment"># Zhou_Ni</span>
beta<span class="token operator">=</span><span class="token number">4.471175</span>                                   <span class="token comment"># Zhou_Ni</span>
kappa<span class="token operator">=</span><span class="token number">0.443599</span>                                  <span class="token comment"># Zhou_Ni</span>
F_e<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2.699486</span>                                   <span class="token comment"># Zhou_Ni</span>
neta<span class="token operator">=</span><span class="token number">0.469</span>                                      <span class="token comment"># Zhou_Ni</span>


<span class="token triple-quoted-string string">&quot;&quot;&quot;
A = 1                                           #random 1
B = 1.2                                         #random 1
beta=5                                          #random 1
kappa=0.35                                      #random 1
F_e=-3                                          #random 1
neta=0.7                                        #random 1
&quot;&quot;&quot;</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
A = 50                                          #random 2
B = 60                                          #random 2
beta = 10                                       #random 2
kappa = 1.0                                     #random 2
F_e = -5                                        #random 2
neta = 3                                        #random 2
&quot;&quot;&quot;</span>

<span class="token comment">#-----function psi-----</span>
<span class="token keyword">def</span> <span class="token function">psi</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alpha<span class="token operator">=</span><span class="token number">1.875</span> <span class="token operator">*</span> beta
    lambda_psi<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">*</span> kappa
    result<span class="token operator">=</span><span class="token punctuation">(</span>A <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>alpha <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> kappa<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>B <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>beta <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> lambda_psi<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result

<span class="token comment">#-----function rho-----</span>
<span class="token keyword">def</span> <span class="token function">rho</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lambda_psi<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">*</span> kappa
    result<span class="token operator">=</span><span class="token punctuation">(</span>f_e <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>beta <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> lambda_psi<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token comment">#-----function F-----</span>
<span class="token keyword">def</span> <span class="token function">F</span><span class="token punctuation">(</span>rho<span class="token punctuation">,</span> F_e<span class="token punctuation">,</span> neta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    F_3<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">0.45</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span> <span class="token operator">**</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span><span class="token operator">/</span><span class="token number">0.15</span> <span class="token operator">-</span> neta <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    F_2<span class="token operator">=</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span> <span class="token operator">**</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> F_3 <span class="token operator">*</span> <span class="token number">1.3225</span>
    F_1<span class="token operator">=</span><span class="token number">0</span>
    F_0<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> neta <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.15</span> <span class="token operator">**</span> neta <span class="token operator">-</span> F_2 <span class="token operator">*</span> <span class="token number">0.0225</span> <span class="token operator">-</span> F_3 <span class="token operator">*</span> <span class="token number">0.003375</span>
    F_n0<span class="token operator">=</span>F_0 <span class="token operator">+</span> F_2 <span class="token operator">*</span> <span class="token number">0.0225</span> <span class="token operator">-</span> F_3 <span class="token operator">*</span> <span class="token number">0.003375</span>
    F_n1<span class="token operator">=</span><span class="token number">0.85</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.3</span> <span class="token operator">*</span> F_2 <span class="token operator">+</span> <span class="token number">0.0675</span> <span class="token operator">*</span> F_3<span class="token punctuation">)</span>
    F_n2<span class="token operator">=</span><span class="token number">0.7225</span> <span class="token operator">*</span> <span class="token punctuation">(</span>F_2 <span class="token operator">-</span> <span class="token number">0.45</span> <span class="token operator">*</span> F_3<span class="token punctuation">)</span>
    F_n3<span class="token operator">=</span>F_n0 <span class="token operator">+</span> F_n2 <span class="token operator">-</span> F_n1

    <span class="token keyword">if</span> rho<span class="token operator">&lt;</span><span class="token number">0.85</span> <span class="token operator">*</span> rho_e<span class="token punctuation">:</span>
        rho_n <span class="token operator">=</span> <span class="token number">0.85</span> <span class="token operator">*</span> rho_e
        result<span class="token operator">=</span>F_n0 <span class="token operator">+</span> F_n1 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> F_n2 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> F_n3 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">if</span> rho<span class="token operator">&lt;</span><span class="token number">1.15</span> <span class="token operator">*</span> rho_e<span class="token punctuation">:</span>
        result<span class="token operator">=</span>F_0 <span class="token operator">+</span> F_1 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> F_2 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> F_3 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span>
        <span class="token keyword">return</span> result
    result<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> neta <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e<span class="token punctuation">)</span> <span class="token operator">**</span> neta
    <span class="token keyword">return</span> result


<span class="token comment">#-----main-----</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'eos-Ni-fcc.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

eos_lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
    parts <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    a_read<span class="token punctuation">,</span> v_read<span class="token punctuation">,</span> energy_read <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> parts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    eos_lines<span class="token punctuation">.</span>append<span class="token punctuation">(</span> <span class="token punctuation">(</span>a_read<span class="token punctuation">,</span> v_read<span class="token punctuation">,</span> energy_read<span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token keyword">for</span> eos <span class="token keyword">in</span> eos_lines<span class="token punctuation">:</span>
    a<span class="token operator">=</span>eos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                              <span class="token comment">#every step lattice constant (A)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'fcc-origin.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

    new_lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        parts <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
        x_read<span class="token punctuation">,</span> y_read<span class="token punctuation">,</span> z_read <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> parts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
        new_x<span class="token punctuation">,</span> new_y<span class="token punctuation">,</span> new_z <span class="token operator">=</span> x_read<span class="token punctuation">,</span> y_read<span class="token punctuation">,</span> z_read
        new_x <span class="token operator">=</span> x_read <span class="token operator">*</span> a  
        new_y <span class="token operator">=</span> y_read <span class="token operator">*</span> a  
        new_z <span class="token operator">=</span> z_read <span class="token operator">*</span> a
        distance <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>new_x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> new_y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> new_z<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
        new_lines<span class="token punctuation">.</span>append<span class="token punctuation">(</span> <span class="token punctuation">(</span>distance<span class="token punctuation">,</span> new_x<span class="token punctuation">,</span> new_y<span class="token punctuation">,</span> new_z<span class="token punctuation">)</span> <span class="token punctuation">)</span>

    rho_<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> atom <span class="token keyword">in</span> new_lines<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> r_cut<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            rho_<span class="token operator">=</span>rho_ <span class="token operator">+</span> rho<span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>beta<span class="token punctuation">,</span>kappa<span class="token punctuation">)</span>

    target_1_sum<span class="token operator">=</span>F<span class="token punctuation">(</span>rho_<span class="token punctuation">,</span> F_e<span class="token punctuation">,</span> neta<span class="token punctuation">)</span>
    <span class="token keyword">for</span> atom <span class="token keyword">in</span> new_lines<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> r_cut<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            target_1_sum<span class="token operator">=</span>target_1_sum <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> psi<span class="token punctuation">(</span>atom<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span>

    target_1<span class="token operator">=</span> <span class="token punctuation">(</span>target_1_sum <span class="token operator">-</span> eos<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span>   <span class="token comment">#eos里面是4个原子的总能量</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>target_1<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br></div></div><h2 id="附录2-表面能计算结果"><a href="#附录2-表面能计算结果" class="header-anchor">#</a> 附录2-表面能计算结果</h2> <p>计算代码</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> math

<span class="token comment">#-----some initial for fcc Ni system-----</span>
a_0<span class="token operator">=</span><span class="token number">3.5196</span>                                        <span class="token comment"># lattice constant (A)</span>
r_e<span class="token operator">=</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">*</span> a_0                          <span class="token comment"># the nearest distance in fcc (A)</span>
omiga<span class="token operator">=</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">3</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">*</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">*</span> a_0<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span> <span class="token comment"># single atom's volume in fcc (A^3)</span>
e_coh <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4.51662718248786</span>

r_cut<span class="token operator">=</span><span class="token number">7.01</span>                                      <span class="token comment"># cutoff radius</span>
rho_e<span class="token operator">=</span><span class="token number">27.562015</span>                                 <span class="token comment"># Zhou_Ni</span>
f_e<span class="token operator">=</span><span class="token number">2.007018</span>                                    <span class="token comment"># Zhou_Ni</span>
A<span class="token operator">=</span><span class="token number">0.429046</span>                                      <span class="token comment"># Zhou_Ni</span>
B<span class="token operator">=</span><span class="token number">0.633531</span>                                      <span class="token comment"># Zhou_Ni</span>
beta<span class="token operator">=</span><span class="token number">4.471175</span>                                   <span class="token comment"># Zhou_Ni</span>
kappa<span class="token operator">=</span><span class="token number">0.443599</span>                                  <span class="token comment"># Zhou_Ni</span>
F_e<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2.699486</span>                                   <span class="token comment"># Zhou_Ni</span>
neta<span class="token operator">=</span><span class="token number">0.469</span>                                      <span class="token comment"># Zhou_Ni</span>

<span class="token comment">#-----function psi-----</span>
<span class="token keyword">def</span> <span class="token function">psi</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alpha<span class="token operator">=</span><span class="token number">1.875</span> <span class="token operator">*</span> beta
    lambda_psi<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">*</span> kappa
    result<span class="token operator">=</span><span class="token punctuation">(</span>A <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>alpha <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> kappa<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>B <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>beta <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> lambda_psi<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result

<span class="token comment">#-----function rho-----</span>
<span class="token keyword">def</span> <span class="token function">rho</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lambda_psi<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">*</span> kappa
    result<span class="token operator">=</span><span class="token punctuation">(</span>f_e <span class="token operator">*</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>beta <span class="token operator">*</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r<span class="token operator">/</span>r_e <span class="token operator">-</span> lambda_psi<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token comment">#-----function F-----</span>
<span class="token keyword">def</span> <span class="token function">F</span><span class="token punctuation">(</span>rho<span class="token punctuation">,</span> F_e<span class="token punctuation">,</span> neta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    F_3<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">0.45</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span> <span class="token operator">**</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span><span class="token operator">/</span><span class="token number">0.15</span> <span class="token operator">-</span> neta <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    F_2<span class="token operator">=</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.15</span> <span class="token operator">**</span> <span class="token punctuation">(</span>neta <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> F_3 <span class="token operator">*</span> <span class="token number">1.3225</span>
    F_1<span class="token operator">=</span><span class="token number">0</span>
    F_0<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> neta <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.15</span> <span class="token operator">**</span> neta <span class="token operator">-</span> F_2 <span class="token operator">*</span> <span class="token number">0.0225</span> <span class="token operator">-</span> F_3 <span class="token operator">*</span> <span class="token number">0.003375</span>
    F_n0<span class="token operator">=</span>F_0 <span class="token operator">+</span> F_2 <span class="token operator">*</span> <span class="token number">0.0225</span> <span class="token operator">-</span> F_3 <span class="token operator">*</span> <span class="token number">0.003375</span>
    F_n1<span class="token operator">=</span><span class="token number">0.85</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.3</span> <span class="token operator">*</span> F_2 <span class="token operator">+</span> <span class="token number">0.0675</span> <span class="token operator">*</span> F_3<span class="token punctuation">)</span>
    F_n2<span class="token operator">=</span><span class="token number">0.7225</span> <span class="token operator">*</span> <span class="token punctuation">(</span>F_2 <span class="token operator">-</span> <span class="token number">0.45</span> <span class="token operator">*</span> F_3<span class="token punctuation">)</span>
    F_n3<span class="token operator">=</span>F_n0 <span class="token operator">+</span> F_n2 <span class="token operator">-</span> F_n1

    <span class="token keyword">if</span> rho<span class="token operator">&lt;</span><span class="token number">0.85</span> <span class="token operator">*</span> rho_e<span class="token punctuation">:</span>
        rho_n <span class="token operator">=</span> <span class="token number">0.85</span> <span class="token operator">*</span> rho_e
        result<span class="token operator">=</span>F_n0 <span class="token operator">+</span> F_n1 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> F_n2 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> F_n3 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">if</span> rho<span class="token operator">&lt;</span><span class="token number">1.15</span> <span class="token operator">*</span> rho_e<span class="token punctuation">:</span>
        result<span class="token operator">=</span>F_0 <span class="token operator">+</span> F_1 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> F_2 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> F_3 <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">3</span>
        <span class="token keyword">return</span> result
    result<span class="token operator">=</span>F_e <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> neta <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>rho<span class="token operator">/</span>rho_e<span class="token punctuation">)</span> <span class="token operator">**</span> neta
    <span class="token keyword">return</span> result

<span class="token keyword">def</span> <span class="token function">read_contcar</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;read CONTCAR file, return lattice vector and coordinates of atoms&quot;&quot;&quot;</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read lattice constant</span>
    scale <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read lattice vector</span>
    lattice <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        lattice<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>scale <span class="token operator">*</span> <span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    lattice <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># read atom type and atom count</span>
    <span class="token comment"># atom_types = lines[5].split()</span>
    atom_counts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> lines<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    total_atoms <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>atom_counts<span class="token punctuation">)</span>
    
    <span class="token comment"># check coordinates type of CONTCAR</span>
    coord_type <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># read atom coordinates</span>
    coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token operator">+</span> total_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        parts <span class="token operator">=</span> lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">:</span>
            coords<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> parts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    coords <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>coords<span class="token punctuation">)</span>
    
    <span class="token comment"># convert coordinates for d, direction</span>
    <span class="token keyword">if</span> coord_type<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        coords <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> lattice<span class="token punctuation">,</span> coords<span class="token punctuation">,</span> total_atoms

<span class="token keyword">def</span> <span class="token function">apply_pbc</span><span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;apply pbc to convert atoms to the initial box&quot;&quot;&quot;</span>

    <span class="token comment"># cal the inverse of lattice vector</span>
    inv_lattice <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># convert atom coordinates to fractional coodinations</span>
    fractional <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> inv_lattice<span class="token punctuation">)</span>

    <span class="token comment"># make sure the atom fractional coordinates range in (0,1]</span>
    fractional <span class="token operator">-=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>fractional<span class="token punctuation">)</span>
    
    <span class="token comment"># turn back the direct coordinates</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>fractional<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">calculate_atomic_energies</span><span class="token punctuation">(</span>lattice<span class="token punctuation">,</span> coords<span class="token punctuation">,</span> n_atoms<span class="token punctuation">,</span> cutoff<span class="token operator">=</span><span class="token number">7.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token comment"># apply pbc to convert atoms to the initial box</span>
    coords_pbc <span class="token operator">=</span> apply_pbc<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>
    
    <span class="token comment"># create a 5x5x5 supercell</span>
    images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span>    
    <span class="token comment"># calculation energies of every atom</span>
    energies <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span>
    rho_ <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span>
    psi_ <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_atoms<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># atom i's direct coordinates</span>
            r_i <span class="token operator">=</span> coords_pbc<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

            <span class="token keyword">for</span> image <span class="token keyword">in</span> images<span class="token punctuation">:</span>
                <span class="token comment"># scan all atom j in view of pbc</span>
                r_j_image <span class="token operator">=</span> coords_pbc<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>image<span class="token punctuation">,</span> lattice<span class="token punctuation">)</span>

                <span class="token comment"># calculate the distance of i,j</span>
                delta <span class="token operator">=</span> r_j_image <span class="token operator">-</span> r_i
                dist <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>delta<span class="token punctuation">)</span>
                
                <span class="token comment"># if the distance is less than cutoff ,calculate electron density</span>
                <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;</span> dist <span class="token operator">&lt;=</span> cutoff<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> i <span class="token operator">==</span> j <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span>image <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        rho_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> rho<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span>
                        psi_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token operator">*</span> psi<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        rho_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> rho<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span>
                        psi_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token operator">*</span> psi<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> kappa<span class="token punctuation">)</span>
        energies<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> psi_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> F<span class="token punctuation">(</span>rho_<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> F_e<span class="token punctuation">,</span> neta<span class="token punctuation">)</span>
    <span class="token keyword">return</span> energies

<span class="token comment">#-----main-----</span>
contcar_file <span class="token operator">=</span> <span class="token string">'CONTCAR'</span>
cutoff <span class="token operator">=</span> <span class="token number">7.01</span>
lattice<span class="token punctuation">,</span> coords<span class="token punctuation">,</span> n_atoms <span class="token operator">=</span> read_contcar<span class="token punctuation">(</span>contcar_file<span class="token punctuation">)</span>
atomic_energies <span class="token operator">=</span> calculate_atomic_energies<span class="token punctuation">(</span>lattice<span class="token punctuation">,</span> coords<span class="token punctuation">,</span> n_atoms<span class="token punctuation">,</span> cutoff<span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> energy <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>atomic_energies<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;atom </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>energy<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string"> eV&quot;</span></span><span class="token punctuation">)</span>

total_energy <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>atomic_energies<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;total: </span><span class="token interpolation"><span class="token punctuation">{</span>total_energy<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string"> eV&quot;</span></span><span class="token punctuation">)</span>

surface_energy <span class="token operator">=</span> <span class="token punctuation">(</span>total_energy <span class="token operator">-</span> n_atoms <span class="token operator">*</span> e_coh<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> lattice<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> lattice<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;surface: </span><span class="token interpolation"><span class="token punctuation">{</span>surface_energy<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string"> eV/ AA^-2&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br></div></div><p>使用接近Zhou势的一组参数对于总能量的计算结果：-50.580449 eV，DFT中的计算结果：-62.20649690 eV。（但是因为总能量的0势能基准不同，参考价值不大）</p> <p>Zhou势100表面能计算结果为0.146044 eV/ AA^-2，DFT中的计算结果为0.1378 eV/ AA^-2。</p></div> <footer class="page-edit" style="margin:0;"><div class="edit-link"><a href="https://github.com/IfXie-Solid-Mechanics/my-first-repo/edit/master/EAM_Develop/4_EAM_basic_energy.md" target="_blank" rel="noopener noreferrer">完善页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----></div></div>  <main class="footer"> <div class="copy-right"><span class="name"> 编程导航   |     </span> <a target="_blank" rel="noreferrer">
          
        </a></div></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.73c90eca.js" defer></script><script src="/assets/js/2.080a77f4.js" defer></script><script src="/assets/js/78.09f354db.js" defer></script>
  </body>
</html>
